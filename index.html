<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุธููุฉ ุงูุชูุฒูุน ุงูุฑููู v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        @media print {

            /* Hide everything in body */
            body>*:not(#printReportContainer) {
                display: none !important;
            }

            /* Show report container */
            #printReportContainer {
                display: block !important;
                visibility: visible !important;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                z-index: 9999;
                background: white;
            }

            /* Ensure content inside is visible */
            #printReportContainer * {
                visibility: visible !important;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
                break-inside: avoid;
                min-height: 100vh;
            }

            @page {
                size: A4;
                margin: 0.5cm;
            }
        }
    </style>
</head>

<body class="pb-20">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 glass border-b border-white/5 px-6 py-4 mb-8 no-print">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div
                    class="w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/20">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                    </svg>
                </div>
                <div>
                    <h1
                        class="text-xl font-black tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400">
                        ููุธููุฉ ุงูุชูุฒูุน ุงูุฑููู</h1>
                    <p class="text-[10px] text-indigo-400 font-bold uppercase tracking-widest">Digital Distribution
                        System</p>
                </div>
            </div>
            <div class="flex bg-slate-800/50 p-1.5 rounded-2xl gap-2 border border-white/5 no-print">
                <button onclick="navigate('supervisor')" id="nav-supervisor"
                    class="px-5 py-2 rounded-xl text-sm font-bold transition-all duration-300 tab-active">ุจูุงุจุฉ
                    ุงูููุฌู</button>
                <button onclick="navigate('admin')" id="nav-admin"
                    class="px-5 py-2 rounded-xl text-sm font-bold transition-all duration-300 text-slate-400 hover:text-white">ููุญุฉ
                    ุงูุฅุฏุงุฑุฉ</button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 md:px-6">

        <!-- View: Supervisor -->
        <section id="view-supervisor" class="space-y-8 max-w-2xl mx-auto">
            <div class="glass rounded-[2.5rem] p-10 text-center relative overflow-hidden group">
                <div
                    class="absolute -top-24 -right-24 w-48 h-48 bg-indigo-500/10 rounded-full blur-3xl group-hover:bg-indigo-500/20 transition-all duration-700">
                </div>
                <h2 class="text-3xl font-black mb-4">ุชุณุฌูู ุงูุฏุฎูู</h2>
                <p class="text-slate-400 mb-8 font-medium">ุฃุฏุฎู ุงูููุฏ ุงูุฎุงุต ุจู ููุจุฏุก ูู ุงุฎุชูุงุฑ ุงูุฑุบุจุงุช ุงููุฏุฑุณูุฉ</p>

                <div class="space-y-4">
                    <select id="loginGuidance" onchange="updateLoginSupervisorList()"
                        class="w-full p-5 bg-slate-950/80 rounded-2xl text-sm border border-white/10 text-indigo-300 focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
                        <option value="">ุงุฎุชุฑ ุงูุชูุฌูู ุงูุฎุงุต ุจู...</option>
                    </select>

                    <!-- Password Field for Guidance -->
                    <input type="password" id="guidancePassword" placeholder="๐ ุฃุฏุฎู ุจุงุณููุฑุฏ ุงูุชูุฌูู"
                        class="w-full p-5 bg-slate-950/80 rounded-2xl text-sm border border-white/10 text-amber-300 focus:ring-2 focus:ring-amber-500 outline-none transition-all">

                    <div class="relative">
                        <input list="supervisorList" id="loginSupervisorInput"
                            placeholder="ุงูุชุจ ุงุณู ุงูููุฌู ููุง ููุจุญุซ..."
                            class="w-full p-5 bg-slate-950/80 rounded-2xl text-sm border border-white/10 text-emerald-300 focus:ring-2 focus:ring-emerald-500 outline-none transition-all">
                        <datalist id="supervisorList"></datalist>
                    </div>
                    <button onclick="handleLogin()" id="loginBtn"
                        class="w-full btn-premium py-5 rounded-2xl font-black text-lg flex items-center justify-center gap-3">
                        <span>ุฏุฎูู ุงููุธุงู</span>
                        <div id="loginLoading" class="hidden loading-spinner"></div>
                    </button>
                    <div class="pt-2">
                        <button onclick="syncAllData()"
                            class="text-[10px] text-slate-500 hover:text-indigo-400 transition-colors flex items-center justify-center gap-2 mx-auto">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุงูุดูุช
                        </button>
                    </div>
                </div>
            </div>

            <!-- Wishes Form (Hidden) -->
            <div id="wishesSection" class="hidden space-y-6 animate-in slide-in-from-bottom duration-500 pb-20">

                <!-- Assignment Card (NEW: Shows only when assigned) -->
                <div id="assignmentCard" class="hidden animate-in zoom-in duration-500">
                    <div
                        class="glass p-6 rounded-[2rem] border-2 border-emerald-500/50 bg-emerald-500/10 text-center relative overflow-hidden">
                        <div
                            class="absolute top-0 right-0 w-32 h-32 bg-emerald-500/20 rounded-full blur-3xl -mr-16 -mt-16">
                        </div>
                        <div class="relative z-10">
                            <div
                                class="w-16 h-16 bg-emerald-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-emerald-500/30">
                                <span class="text-3xl">๐</span>
                            </div>
                            <h3 class="text-white font-black text-xl mb-1">ุชู ุชููููู ุฑุณููุงู!</h3>
                            <p class="text-emerald-200 text-sm mb-6">ุชู ุงุนุชูุงุฏ ุชูุฒูุนู ูููุฏุฑุณุฉ ุงูุชุงููุฉ</p>

                            <div class="bg-black/30 rounded-2xl p-4 mb-6 border border-emerald-500/20">
                                <h2 id="assignedSchoolName" class="text-2xl font-black text-white mb-2">ุงุณู ุงููุฏุฑุณุฉ ููุง
                                </h2>
                                <p id="assignedSchoolGov" class="text-emerald-400 text-xs font-bold">ุงูุฅุฏุงุฑุฉ ุงูุชุนููููุฉ
                                </p>
                            </div>

                            <button onclick="printAssignmentLetter()"
                                class="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-4 rounded-xl font-bold shadow-lg shadow-emerald-900/20 flex items-center justify-center gap-2 transition-all active:scale-95">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                    </path>
                                </svg>
                                ุทุจุงุนุฉ ุฎุทุงุจ ุงูุชูููู
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Header Info -->
                <div class="glass rounded-[2rem] p-6 flex flex-col gap-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 id="supHello" class="text-xl font-black text-white mb-1"></h3>
                            <p class="text-slate-400 text-xs">ุฃููุงู ุจู ูู ูุธุงู ุงูุชูุฒูุน ุงูุฑููู</p>
                        </div>
                        <button onclick="navigate('supervisor')"
                            class="p-2 bg-white/5 rounded-xl text-slate-400 hover:text-white transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                        </button>
                    </div>
                    <div class="flex gap-2">
                        <span id="supGuidance"
                            class="px-3 py-1.5 bg-indigo-500/10 text-indigo-300 rounded-lg text-[10px] font-bold border border-indigo-500/20"></span>
                        <span id="supSpecialty"
                            class="px-3 py-1.5 bg-emerald-500/10 text-emerald-300 rounded-lg text-[10px] font-bold border border-emerald-500/20"></span>
                    </div>
                </div>

                <!-- Accordion Wishes (Mobile First) -->
                <div class="space-y-3" id="wishesAccordion">
                    <!-- Wish 1 -->
                    <div class="glass rounded-2xl overflow-hidden border border-white/5 transition-all duration-300 group wish-card active"
                        data-index="1">
                        <button onclick="toggleWishAccordion(1)"
                            class="w-full p-4 flex items-center justify-between text-right">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-lg bg-indigo-600 flex items-center justify-center text-white font-black text-sm shadow-lg shadow-indigo-500/30">
                                    1</div>
                                <div>
                                    <p class="text-sm font-bold text-white">ุงูุฑุบุจุฉ ุงูุฃููู</p>
                                    <p class="text-[10px] text-indigo-300 mt-0.5 selected-school-label"
                                        id="label-wish-1">ูู ูุชู ุงูุงุฎุชูุงุฑ</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-slate-500 transform transition-transform group-[.active]:rotate-180"
                                fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div
                            class="hidden group-[.active]:block p-4 pt-0 space-y-3 animate-in fade-in slide-in-from-top-2">
                            <div class="grid grid-cols-2 gap-3">
                                <select id="filter-stage-1" onchange="renderSchoolSelects(1)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full outline-none focus:border-indigo-500 transition-all">
                                    <option value="">ูู ุงููุฑุงุญู</option>
                                </select>
                                <select id="filter-type-1" onchange="renderSchoolSelects(1)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full outline-none focus:border-indigo-500 transition-all">
                                    <option value="">ูู ุงูููุนูุงุช</option>
                                </select>
                            </div>
                            <select id="wish1"
                                class="w-full p-4 bg-slate-950 rounded-xl text-sm border-2 border-indigo-500/30 text-white outline-none focus:border-indigo-500 transition-all school-select"
                                onchange="updateWishLabel(1)"></select>
                        </div>
                    </div>

                    <!-- Wish 2 -->
                    <div class="glass rounded-2xl overflow-hidden border border-white/5 transition-all duration-300 group wish-card"
                        data-index="2">
                        <button onclick="toggleWishAccordion(2)"
                            class="w-full p-4 flex items-center justify-between text-right">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-lg bg-slate-700 flex items-center justify-center text-slate-400 font-black text-sm group-[.active]:bg-indigo-600 group-[.active]:text-white transition-colors">
                                    2</div>
                                <div>
                                    <p class="text-sm font-bold text-slate-300 group-[.active]:text-white">ุงูุฑุบุจุฉ
                                        ุงูุซุงููุฉ</p>
                                    <p class="text-[10px] text-slate-500 mt-0.5 selected-school-label"
                                        id="label-wish-2">ูู ูุชู ุงูุงุฎุชูุงุฑ</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-slate-500 transform transition-transform group-[.active]:rotate-180"
                                fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="hidden group-[.active]:block p-4 pt-0 space-y-3">
                            <div class="grid grid-cols-2 gap-3">
                                <select id="filter-stage-2" onchange="renderSchoolSelects(2)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงููุฑุงุญู</option>
                                </select>
                                <select id="filter-type-2" onchange="renderSchoolSelects(2)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงูููุนูุงุช</option>
                                </select>
                            </div>
                            <select id="wish2"
                                class="w-full p-4 bg-slate-950 rounded-xl text-sm border-2 border-white/10 text-white outline-none focus:border-indigo-500 transition-all school-select"
                                onchange="updateWishLabel(2)"></select>
                        </div>
                    </div>

                    <!-- Wish 3 -->
                    <div class="glass rounded-2xl overflow-hidden border border-white/5 transition-all duration-300 group wish-card"
                        data-index="3">
                        <button onclick="toggleWishAccordion(3)"
                            class="w-full p-4 flex items-center justify-between text-right">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-lg bg-slate-700 flex items-center justify-center text-slate-400 font-black text-sm group-[.active]:bg-indigo-600 group-[.active]:text-white transition-colors">
                                    3</div>
                                <div>
                                    <p class="text-sm font-bold text-slate-300 group-[.active]:text-white">ุงูุฑุบุจุฉ
                                        ุงูุซุงูุซุฉ</p>
                                    <p class="text-[10px] text-slate-500 mt-0.5 selected-school-label"
                                        id="label-wish-3">ูู ูุชู ุงูุงุฎุชูุงุฑ</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-slate-500 transform transition-transform group-[.active]:rotate-180"
                                fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="hidden group-[.active]:block p-4 pt-0 space-y-3">
                            <div class="grid grid-cols-2 gap-3">
                                <select id="filter-stage-3" onchange="renderSchoolSelects(3)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงููุฑุงุญู</option>
                                </select>
                                <select id="filter-type-3" onchange="renderSchoolSelects(3)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงูููุนูุงุช</option>
                                </select>
                            </div>
                            <select id="wish3"
                                class="w-full p-4 bg-slate-950 rounded-xl text-sm border-2 border-white/10 text-white outline-none focus:border-indigo-500 transition-all school-select"
                                onchange="updateWishLabel(3)"></select>
                        </div>
                    </div>

                    <!-- Wish 4 -->
                    <div class="glass rounded-2xl overflow-hidden border border-white/5 transition-all duration-300 group wish-card"
                        data-index="4">
                        <button onclick="toggleWishAccordion(4)"
                            class="w-full p-4 flex items-center justify-between text-right">
                            <div class="flex items-center gap-3">
                                <div
                                    class="w-8 h-8 rounded-lg bg-slate-700 flex items-center justify-center text-slate-400 font-black text-sm group-[.active]:bg-indigo-600 group-[.active]:text-white transition-colors">
                                    4</div>
                                <div>
                                    <p class="text-sm font-bold text-slate-300 group-[.active]:text-white">ุงูุฑุบุจุฉ
                                        ุงูุฑุงุจุนุฉ</p>
                                    <p class="text-[10px] text-slate-500 mt-0.5 selected-school-label"
                                        id="label-wish-4">ูู ูุชู ุงูุงุฎุชูุงุฑ</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-slate-500 transform transition-transform group-[.active]:rotate-180"
                                fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div class="hidden group-[.active]:block p-4 pt-0 space-y-3">
                            <div class="grid grid-cols-2 gap-3">
                                <select id="filter-stage-4" onchange="renderSchoolSelects(4)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงููุฑุงุญู</option>
                                </select>
                                <select id="filter-type-4" onchange="renderSchoolSelects(4)"
                                    class="p-3 bg-slate-950/50 rounded-xl text-xs border border-white/10 text-slate-300 w-full">
                                    <option value="">ูู ุงูููุนูุงุช</option>
                                </select>
                            </div>
                            <select id="wish4"
                                class="w-full p-4 bg-slate-950 rounded-xl text-sm border-2 border-white/10 text-white outline-none focus:border-indigo-500 transition-all school-select"
                                onchange="updateWishLabel(4)"></select>
                        </div>
                    </div>
                </div>

                <div class="glass p-8 rounded-3xl border-l-4 border-l-amber-500 bg-amber-500/5">
                    <p class="text-sm leading-relaxed text-slate-300">
                        <strong class="text-amber-500">ููุงุญุธุฉ ูุงูุฉ:</strong> ุงููุฏุงุฑุณ ุงููููุฒุฉ ุจูุฌูุฉ (<span
                            class="text-amber-400">โญ</span>) ูู ุงููุฏุงุฑุณ ุงูุชุงุจุนุฉ ูุชุฎุตุตู. ููููู ุงุฎุชูุงุฑ ุฃู ูุฏุฑุณุฉ ุฃุฎุฑู ููู
                        ุงูุฃููููุฉ ููุฑุบุจุงุช ุงูููุณุฌูุฉ ูุน ุชุฎุตุต ุงูููุฌู.
                    </p>
                </div>

                <button onclick="submitWishes()" id="submitBtn"
                    class="w-full bg-emerald-600 hover:bg-emerald-700 py-6 rounded-2xl font-black text-xl transition-all shadow-lg shadow-emerald-900/20 flex items-center justify-center gap-4">
                    <span>ุญูุธ ุงูุฑุบุจุงุช ุงูุขู</span>
                    <div id="submitLoading" class="hidden loading-spinner"></div>
                </button>
            </div>
        </section>

        <!-- View: Admin -->
        <section id="view-admin" class="hidden space-y-8 animate-in fade-in duration-500">
            <!-- Admin Navigation Sub-tabs -->
            <div class="flex gap-2 flex-wrap mb-6 no-print">
                <button onclick="switchAdminTab('sync')" id="admin-tab-sync"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all tab-active flex-1 whitespace-nowrap bg-indigo-600">ุงููุฒุงููุฉ</button>
                <button onclick="switchAdminTab('settings')" id="admin-tab-settings"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">โ๏ธ
                    ุงูุฅุนุฏุงุฏุงุช</button>
                <button onclick="switchAdminTab('data')" id="admin-tab-data"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">๐
                    ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช</button>
                <button onclick="switchAdminTab('status')" id="admin-tab-status"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">๐ฅ
                    ุญุงูุฉ ุงูููุฌููู</button>
                <button onclick="switchAdminTab('mandatory')" id="admin-tab-mandatory"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">ุงูุชูููู
                    ุงูุฅุฌุจุงุฑู</button>
                <button onclick="switchAdminTab('results')" id="admin-tab-results"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">ุงููุชุงุฆุฌ</button>
                <button onclick="switchAdminTab('raw')" id="admin-tab-raw"
                    class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:text-white flex-1 whitespace-nowrap bg-slate-800">ุงูุจูุงูุงุช</button>
            </div>

            <!-- Config Card -->
            <div id="admin-view-sync" class="glass rounded-[2.5rem] p-10">
                <h3 class="text-2xl font-bold mb-6 flex items-center gap-3 text-indigo-400">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    ุฅุนุฏุงุฏุงุช ุงููุฒุงููุฉ ุงูุดุงููุฉ
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <label class="text-xs font-bold text-slate-500 uppercase tracking-widest px-2">ูุนุฑู ููู ุฌูุฌู ุดูุช
                            (Sheet ID)</label>
                        <input type="text" id="sheetId" placeholder="ูุซุงู: 1a2b3c4d5e6f7g8h9i0j..."
                            class="w-full p-4 input-premium rounded-xl font-mono text-sm">
                    </div>
                    <div class="space-y-4">
                        <label class="text-xs font-bold text-slate-500 uppercase tracking-widest px-2">ุฑุงุจุท GAS Web App
                            (ููุงุณุชูุจุงู)</label>
                        <input type="text" id="gasUrl" placeholder="https://script.google.com/macros/s/.../exec"
                            class="w-full p-4 input-premium rounded-xl font-mono text-sm">
                    </div>
                </div>

                <div class="mt-10 pt-8 border-t border-white/5 flex flex-wrap gap-4">
                    <button onclick="syncAllData()"
                        class="btn-premium px-8 py-4 rounded-xl flex items-center gap-3 font-bold group">
                        <svg class="w-5 h-5 group-hover:rotate-180 transition-transform duration-500" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        ูุฒุงููุฉ ูุชุญููู ุงูุจูุงูุงุช
                    </button>
                    <button onclick="exportResults()" id="exportExcel"
                        class="bg-slate-800 hover:bg-slate-700 px-8 py-4 rounded-xl flex items-center gap-3 font-bold border border-white/10">
                        ุชุตุฏูุฑ ุงูุชูุฒูุน ุงูููุงุฆู
                    </button>
                    <button onclick="window.print()"
                        class="bg-indigo-600 hover:bg-indigo-700 px-8 py-4 rounded-xl flex items-center gap-3 font-bold border border-white/10 no-print">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                        </svg>
                        ุทุจุงุนุฉ ูุดู ุงูุชูุฒูุน
                    </button>
                </div>

                <!-- Sync Log / Diagnostics -->
                <div class="mt-8 bg-slate-950/50 rounded-2xl p-6 border border-white/5 font-mono text-xs">
                    <p class="text-indigo-400 font-bold mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 bg-indigo-500 rounded-full animate-pulse"></span>
                        ุณุฌู ุงููุฒุงููุฉ ุงูููู (Technical Log)
                    </p>
                    <div id="syncLog" class="space-y-1 max-h-48 overflow-y-auto custom-scrollbar">
                        <div class="text-slate-500">ุจุงูุชุธุงุฑ ุจุฏุก ุงููุฒุงููุฉ...</div>
                    </div>
                </div>
            </div>

            <!-- Admin View: Full Data Management -->
            <div id="admin-view-data" class="hidden space-y-6">
                <!-- Sub Navigation -->
                <div class="grid grid-cols-3 gap-4 bg-slate-900/50 p-2 rounded-2xl">
                    <button onclick="renderManagementTable('schools')" id="mgmt-btn-schools"
                        class="px-4 py-3 rounded-xl text-xs font-bold transition-all bg-indigo-600 text-white">๐ซ ุฅุฏุงุฑุฉ
                        ุงููุฏุงุฑุณ</button>
                    <button onclick="renderManagementTable('supervisors')" id="mgmt-btn-supervisors"
                        class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:bg-slate-800">๐ค
                        ุฅุฏุงุฑุฉ ุงูููุฌููู</button>
                    <button onclick="renderManagementTable('guidance')" id="mgmt-btn-guidance"
                        class="px-4 py-3 rounded-xl text-xs font-bold transition-all text-slate-400 hover:bg-slate-800">๐
                        ุฅุฏุงุฑุฉ ุงูุชูุฌููุงุช</button>
                </div>

                <div class="glass rounded-[2rem] p-8">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 id="mgmtTitle" class="text-2xl font-black text-white">ุฅุฏุงุฑุฉ ุงููุฏุงุฑุณ</h3>
                            <p class="text-slate-400 text-sm mt-1">ุนุฑุถ ูุชุนุฏูู ูุญุฐู ุงูุจูุงูุงุช</p>
                        </div>
                        <div class="flex gap-3">
                            <input type="text" id="mgmtSearch" onkeyup="filterManagementTable()" placeholder="๐ ุจุญุซ..."
                                class="bg-slate-950/50 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 w-64">
                            <button onclick="openAddModal()"
                                class="bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-xl text-xs font-bold flex items-center gap-2">
                                โ ุฅุถุงูุฉ ุฌุฏูุฏ
                            </button>
                        </div>
                    </div>

                    <div class="overflow-x-auto max-h-[600px] overflow-y-auto rounded-xl border border-white/5">
                        <table class="w-full text-right" id="mgmtTable">
                            <thead class="sticky top-0 z-10 bg-indigo-950 text-slate-300" id="mgmtHead">
                                <!-- Dynamic Headers -->
                            </thead>
                            <tbody id="mgmtBody" class="divide-y divide-white/5 font-medium bg-slate-900/30">
                                <!-- Dynamic Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Admin View: Settings -->
            <div id="admin-view-settings" class="hidden space-y-8 animate-in fade-in duration-500">
                <div class="glass rounded-[2rem] p-8">
                    <!-- Header -->
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-2xl font-black text-white">โ๏ธ ุฅุนุฏุงุฏุงุช ุงููุธุงู</h3>
                            <p class="text-slate-400 text-sm mt-1">ุชุฎุตูุต ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ูุงููุณุคูููู</p>
                        </div>
                        <button onclick="saveSettings()"
                            class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-xl font-bold transition-all flex items-center gap-2 shadow-lg shadow-emerald-900/20">
                            ๐พ ุญูุธ ุงูุชุบููุฑุงุช
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- General Settings -->
                        <div class="space-y-6">
                            <h4 class="text-lg font-bold text-indigo-300 border-b border-white/10 pb-2">๐ ุจูุงูุงุช ุนุงูุฉ
                            </h4>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="col-span-2">
                                    <label class="block text-xs text-slate-400 mb-1">ุงููุญุงูุธุฉ</label>
                                    <input type="text" id="set_governorate"
                                        class="w-full bg-slate-950/50 border border-white/10 rounded-lg px-3 py-3 text-sm text-white focus:border-indigo-500 transition-all">
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-xs text-slate-400 mb-1">ุงูุฅุฏุงุฑุฉ ุงูุชุนููููุฉ</label>
                                    <input type="text" id="set_directorate"
                                        class="w-full bg-slate-950/50 border border-white/10 rounded-lg px-3 py-3 text-sm text-white focus:border-indigo-500 transition-all">
                                </div>
                                <div>
                                    <label class="block text-xs text-slate-400 mb-1">ุงูุนุงู ุงูุฏุฑุงุณู</label>
                                    <input type="text" id="set_year"
                                        class="w-full bg-slate-950/50 border border-white/10 rounded-lg px-3 py-3 text-sm text-white focus:border-indigo-500 transition-all"
                                        placeholder="ูุซุงู: 2025/2026">
                                </div>
                                <div>
                                    <label class="block text-xs text-slate-400 mb-1">ุงููุตู ุงูุฏุฑุงุณู</label>
                                    <select id="set_semester"
                                        class="w-full bg-slate-950/50 border border-white/10 rounded-lg px-3 py-3 text-sm text-white focus:border-indigo-500 transition-all">
                                        <option value="ูุตู ุงูุนุงู">ูุตู ุงูุนุงู</option>
                                        <option value="ุขุฎุฑ ุงูุนุงู">ุขุฎุฑ ุงูุนุงู</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Officials Settings -->
                        <div class="space-y-6">
                            <h4 class="text-lg font-bold text-indigo-300 border-b border-white/10 pb-2">๐ค ุจูุงูุงุช
                                ุงููุณุคูููู</h4>

                            <div class="space-y-4">
                                <!-- GM -->
                                <div>
                                    <label class="block text-xs text-slate-400 mb-1">ูุฏูุฑ ุนุงู ุงูุฅุฏุงุฑุฉ</label>
                                    <div class="flex gap-2">
                                        <input type="text" id="set_gm_name" placeholder="ุงูุงุณู"
                                            class="flex-[2] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                        <input type="text" id="set_gm_title" placeholder="ุงูููุจ"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                        <input type="text" id="set_gm_phone" placeholder="๐ ุงููุงุชู"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                            dir="ltr">
                                    </div>
                                </div>

                                <!-- Deputy -->
                                <div>
                                    <label class="block text-xs text-slate-400 mb-1">ูููู ุงูุฅุฏุงุฑุฉ</label>
                                    <div class="flex gap-2">
                                        <input type="text" id="set_deputy_name" placeholder="ุงูุงุณู"
                                            class="flex-[2] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                        <input type="text" id="set_deputy_title" placeholder="ุงูููุจ"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                        <input type="text" id="set_deputy_phone" placeholder="๐ ุงููุงุชู"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                            dir="ltr">
                                    </div>
                                </div>

                                <!-- Security -->
                                <div>
                                    <label class="block text-xs text-slate-400 mb-1">ูุณุคูู ุฃูู ุงูุฅุฏุงุฑุฉ</label>
                                    <div class="flex gap-2">
                                        <input type="text" id="set_security_name" placeholder="ุงูุงุณู"
                                            class="flex-[2] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                        <input type="text" id="set_security_title" placeholder="ุงูููุจ"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500"
                                            value="ูุณุคูู ุฃูู ุงูุฅุฏุงุฑุฉ">
                                        <input type="text" id="set_security_phone" placeholder="๐ ุงููุงุชู"
                                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                            dir="ltr">
                                    </div>
                                </div>

                                <!-- Stage Managers -->
                                <div class="grid grid-cols-1 gap-3 pt-2 border-t border-white/5">
                                    <div>
                                        <label class="block text-xs text-slate-400 mb-1">ูุฏูุฑ ุงูุชุนููู ุงูุงุจุชุฏุงุฆู</label>
                                        <div class="flex gap-2">
                                            <input type="text" id="set_mgr_primary" placeholder="ุงูุงุณู"
                                                class="flex-[3] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                            <input type="text" id="set_mgr_primary_phone" placeholder="๐ ุงููุงุชู"
                                                class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                                dir="ltr">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs text-slate-400 mb-1">ูุฏูุฑ ุงูุชุนููู ุงูุฅุนุฏุงุฏู</label>
                                        <div class="flex gap-2">
                                            <input type="text" id="set_mgr_prep" placeholder="ุงูุงุณู"
                                                class="flex-[3] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                            <input type="text" id="set_mgr_prep_phone" placeholder="๐ ุงููุงุชู"
                                                class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                                dir="ltr">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs text-slate-400 mb-1">ูุฏูุฑ ุงูุชุนููู ุงูุซุงููู</label>
                                        <div class="flex gap-2">
                                            <input type="text" id="set_mgr_sec" placeholder="ุงูุงุณู"
                                                class="flex-[3] bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500">
                                            <input type="text" id="set_mgr_sec_phone" placeholder="๐ ุงููุงุชู"
                                                class="flex-1 bg-slate-950/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-emerald-300 font-mono focus:border-emerald-500 text-center"
                                                dir="ltr">
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-indigo-900/20 p-4 rounded-xl border border-indigo-500/20 mt-4">
                                    <p class="text-[10px] text-indigo-300">๐ก ููุงุญุธุฉ: ูุฐู ุงูุจูุงูุงุช ูุฃุฑูุงู ุงูููุงุชู ุณุชุธูุฑ
                                        ุชููุงุฆูุงู ูู ุฌููุน ุงูุชูุงุฑูุฑ ูุงูููุงุชุจุงุช ุงูุฑุณููุฉ.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="admin-view-mandatory" class="hidden space-y-8">
                <div class="glass rounded-[2rem] p-8">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-8">
                        <div>
                            <h4 class="text-xl font-bold mb-1">ุชุญุฏูุฏ ุงูุชูููู ุงูุฅุฌุจุงุฑู</h4>
                            <p class="text-[10px] text-slate-500">ูู ุจุชุซุจูุช ููุฌููู ูุญุฏุฏูู ููุฏุงุฑุณ ูุนููุฉ ูุจู ุงูุจุฏุก
                                ุจุงูุชูุฒูุน ุงูุชููุงุฆู</p>
                        </div>
                        <input type="text" id="mandatorySearch" onkeyup="filterMandatoryTable()"
                            placeholder="ุจุญุซ ุณุฑูุน ุจุฃุณู ุงููุฏุฑุณุฉ..."
                            class="max-w-md w-full p-3 input-premium rounded-xl text-sm">
                    </div>

                    <!-- Filters Row -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <select id="man-filter-stage" onchange="renderMandatoryTable()"
                            class="p-4 bg-slate-900/50 rounded-xl text-xs border border-white/5 text-indigo-300">
                            <option value="">ุฌููุน ุงููุฑุงุญู</option>
                        </select>
                        <select id="man-filter-type" onchange="renderMandatoryTable()"
                            class="p-4 bg-slate-900/50 rounded-xl text-xs border border-white/5 text-emerald-300">
                            <option value="">ุฌููุน ุงูููุนูุงุช</option>
                        </select>
                        <select id="man-filter-guid" onchange="renderMandatoryTable()"
                            class="p-4 bg-slate-900/50 rounded-xl text-xs border border-white/5 text-sky-300">
                            <option value="">ุฌููุน ุงูุชูุฌููุงุช</option>
                        </select>
                    </div>

                    <!-- Bulk Actions -->
                    <div
                        class="bg-indigo-600/10 border border-indigo-500/20 p-6 rounded-2xl mb-8 flex flex-col md:flex-row items-center justify-between gap-4">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white">
                                โก</div>
                            <div>
                                <p class="text-sm font-bold">ุชุฎุตูุต ุณุฑูุน ูููู</p>
                                <p class="text-[10px] text-slate-400">ุชุทุจูู ููุฌู ูุงุญุฏ ุนูู ูู ุงููุฏุงุฑุณ ุงููุนุฑูุถุฉ ุญุงููุงู
                                    ุจูุงุกู ุนูู ุงูุชุตููุฉ</p>
                            </div>
                        </div>
                        <div class="flex gap-3 w-full md:w-auto">
                            <select id="bulkSupSelect"
                                class="bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-xs focus:border-indigo-500 outline-none transition-all min-w-[200px]">
                                <option value="">ุงุฎุชุฑ ุงูููุฌู...</option>
                            </select>
                            <button onclick="applyBulkMandatory()"
                                class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-xl text-xs font-bold transition-all whitespace-nowrap">ุชุทุจูู
                                ุนูู ุงููู</button>
                        </div>
                    </div>

                    <div class="overflow-x-auto max-h-[600px] border border-white/5 rounded-2xl">
                        <table class="w-full text-right">
                            <thead class="sticky top-0 bg-slate-950 z-10">
                                <tr
                                    class="text-slate-400 text-[10px] uppercase font-black tracking-widest bg-slate-900/80">
                                    <th class="px-6 py-5">ุงููุฏุฑุณุฉ</th>
                                    <th class="px-6 py-5">ุงููุฑุญูุฉ</th>
                                    <th class="px-6 py-5">ุงูููุนูุฉ</th>
                                    <th class="px-6 py-5">ุงูุชูุฌูู</th>
                                    <th class="px-6 py-5">ุงูููุฌู ุงูููููู</th>
                                </tr>
                            </thead>
                            <tbody id="mandatoryBody" class="divide-y divide-white/5">
                                <!-- Populated after sync -->
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-8 flex flex-col md:flex-row justify-end gap-3">
                        <button onclick="saveMandatoryAssignments()"
                            class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-8 py-4 rounded-2xl font-bold border border-white/5 transition-all">ุญูุธ
                            ูุงุฆูุฉ ุงูุชููููุงุช ููุท</button>
                        <button onclick="runDistribution(); showToast('ุชู ุชุญุฏูุซ ุงูุชูุฒูุน ุจูุงุกู ุนูู ุงูุชูููู', '๐ฏ')"
                            class="btn-premium px-10 py-4 rounded-2xl font-black">ุญูุธ ูุจุฏุก ุงูุชุญููู ุงูููุงุฆู</button>
                    </div>
                </div>
            </div>

            <!-- Admin View: Data Management (Restored) -->
            <div id="admin-view-data" class="hidden space-y-8 animate-in fade-in duration-500">
                <div class="glass rounded-[2rem] p-8">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-8">
                        <div>
                            <h3 class="text-2xl font-black text-white" id="mgmtTitle">ุฅุฏุงุฑุฉ ุงููุฏุงุฑุณ</h3>
                            <p class="text-slate-400 text-sm mt-1">ุนุฑุถ ูุชุนุฏูู ูุญุฐู ุงูุณุฌูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช</p>
                        </div>
                        <div class="flex gap-2 p-1 bg-slate-900/50 rounded-xl border border-white/5">
                            <button id="mgmt-btn-schools" onclick="renderManagementTable('schools')"
                                class="px-6 py-2 rounded-lg text-xs font-bold transition-all bg-indigo-600 text-white shadow-lg">ุงููุฏุงุฑุณ</button>
                            <button id="mgmt-btn-supervisors" onclick="renderManagementTable('supervisors')"
                                class="px-6 py-2 rounded-lg text-xs font-bold transition-all text-slate-400 hover:text-white hover:bg-white/5">ุงูููุฌููู</button>
                            <button id="mgmt-btn-guidance" onclick="renderManagementTable('guidance')"
                                class="px-6 py-2 rounded-lg text-xs font-bold transition-all text-slate-400 hover:text-white hover:bg-white/5">ุงูุชูุฌูู</button>
                        </div>
                    </div>

                    <div class="flex gap-4 mb-6">
                        <input type="text" id="mgmtSearch" onkeyup="filterManagementTable()"
                            placeholder="๐ ุจุญุซ ูู ุงูุณุฌูุงุช..."
                            class="flex-1 bg-slate-950/50 border border-white/10 rounded-xl px-4 py-3 text-sm text-white focus:outline-none focus:border-indigo-500 transition-all">
                        <button onclick="openAddModal()"
                            class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-3 rounded-xl text-xs font-bold flex items-center gap-2 shadow-lg shadow-emerald-900/20 transition-all">
                            <span class="text-lg">+</span> ุฅุถุงูุฉ ุฌุฏูุฏ
                        </button>
                    </div>

                    <div class="overflow-x-auto max-h-[600px] overflow-y-auto rounded-xl border border-white/5">
                        <table class="w-full text-right" id="mgmtTable">
                            <thead id="mgmtHead" class="sticky top-0 bg-indigo-950 z-10 text-slate-300">
                                <!-- Dynamic Headers -->
                            </thead>
                            <tbody id="mgmtBody" class="divide-y divide-white/5 font-medium bg-slate-900/30">
                                <!-- Dynamic Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Admin View: Supervisor Status Management -->
            <div id="admin-view-status" class="hidden space-y-8">
                <div class="glass rounded-[2rem] p-8">
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 class="text-2xl font-black text-white">ุฅุฏุงุฑุฉ ุญุงูุฉ ุงูููุฌููู</h3>
                            <p class="text-slate-400 text-sm mt-1">ุชูุนูู ุฃู ุฅููุงู ุงูููุฌููู ูุงุณุชุจุนุงุฏูู ูู ุงูุชูุฒูุน</p>
                        </div>
                        <input type="text" id="statusSearch" onkeyup="renderStatusTable()"
                            placeholder="๐ ุจุญุซ ุจุงูุงุณู..."
                            class="bg-slate-950/50 border border-white/10 rounded-xl px-4 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 w-64">
                    </div>

                    <div class="overflow-x-auto max-h-[600px] overflow-y-auto rounded-xl border border-white/5">
                        <table class="w-full text-right" id="statusTable">
                            <thead class="sticky top-0 z-10">
                                <tr class="bg-indigo-950 text-slate-300">
                                    <th class="px-6 py-4 text-xs font-bold w-20">ุงูููุฏ</th>
                                    <th class="px-6 py-4 text-xs font-bold">ุงุณู ุงูููุฌู</th>
                                    <th class="px-6 py-4 text-xs font-bold">ุงูุชูุฌูู</th>
                                    <th class="px-6 py-4 text-xs font-bold text-center w-40">ุงูุญุงูุฉ ุงูุญุงููุฉ</th>
                                    <th class="px-6 py-4 text-xs font-bold text-center w-40">ุชุบููุฑ ุงูุญุงูุฉ</th>
                                </tr>
                            </thead>
                            <tbody id="statusTableBody" class="divide-y divide-white/5 font-medium bg-slate-900/30">
                                <!-- Dynamic Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Admin View: Results (Dashboard + Table) -->
            <div id="admin-view-results" class="hidden space-y-8 animate-in slide-in-from-bottom duration-700">
                <!-- Dashboard Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="glass p-8 rounded-3xl group">
                        <div class="flex justify-between items-start mb-4">
                            <span class="text-indigo-400 font-black text-xs">ุฅุฌูุงูู ุงููุฏุงุฑุณ</span>
                            <div
                                class="w-8 h-8 rounded-lg bg-indigo-500/10 flex items-center justify-center text-indigo-400">
                                ฮฃ</div>
                        </div>
                        <p id="statSchools" class="text-4xl font-black">0</p>
                    </div>
                    <div class="glass p-8 rounded-3xl group">
                        <div class="flex justify-between items-start mb-4">
                            <span class="text-emerald-400 font-black text-xs">ูุณุจุฉ ุงูุชุบุทูุฉ</span>
                            <div
                                class="w-8 h-8 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-400">
                                %</div>
                        </div>
                        <p id="statCoverage" class="text-4xl font-black">0%</p>
                    </div>
                    <div class="glass p-8 rounded-3xl group">
                        <div class="flex justify-between items-start mb-4">
                            <span class="text-sky-400 font-black text-xs">ุงูููุฌููู ุงููุดุทูู</span>
                            <div class="w-8 h-8 rounded-lg bg-sky-500/10 flex items-center justify-center text-sky-400">
                                ๐ค</div>
                        </div>
                        <p id="statSupervisors" class="text-4xl font-black">0</p>
                    </div>
                    <div class="glass p-8 rounded-3xl group">
                        <div class="flex justify-between items-start mb-4">
                            <span class="text-amber-400 font-black text-xs">ุงูุฑุบุจุงุช ุงููุณุฌูุฉ</span>
                            <div
                                class="w-8 h-8 rounded-lg bg-amber-500/10 flex items-center justify-center text-amber-400">
                                โฅ</div>
                        </div>
                        <p id="statWishes" class="text-4xl font-black">0</p>
                    </div>
                </div>

                <!-- Results Table & Actions -->
                <div class="glass rounded-[2rem] p-8">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-8">
                        <div>
                            <h3 class="text-2xl font-black heading-gradient mb-2">ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ููุชูุฒูุน</h3>
                            <div class="flex gap-4 text-sm font-bold text-slate-400">
                                <span id="resTotalSup">ุงูููุฌููู: 0</span>
                                <span class="text-slate-700">|</span>
                                <span id="resAssigned">ุชู ุชุณููู: 0</span>
                                <span class="text-slate-700">|</span>
                                <span id="resCoverage">ุชุบุทูุฉ: 0%</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-3 items-center w-full">
                            <!-- Row 1: Actions & Main Reports -->
                            <button onclick="runDistribution(); showToast('ุชู ุจุฏุก ุงูุชูุฒูุน ูุชุญุฏูุซ ุงูุจูุงูุงุช', '๐')"
                                class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2 shadow-lg shadow-indigo-900/50 border border-indigo-400/30">
                                โก ุชูุฒูุน ูุฅุตูุงุญ
                            </button>

                            <button onclick="generateUnifiedReport()"
                                class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ ุฌุฏูู ูุงุญุฏ (ูุฌูุน)
                            </button>

                            <button onclick="generateIndividualLetters()"
                                class="bg-amber-600 hover:bg-amber-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                โ๏ธ ุฎุทุงุจุงุช ุงูุชูููู
                            </button>

                            <button onclick="exportToCSV()"
                                class="bg-slate-600 hover:bg-slate-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ฅ ุชุตุฏูุฑ CSV
                            </button>

                            <!-- Row 2: Secondary Reports -->
                            <button onclick="generateOfficialGeneralReport()"
                                class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ ุงููุดู ุงูุนุงู (ููุณู)
                            </button>

                            <button onclick="generateUnassignedReport()"
                                class="bg-rose-600 hover:bg-rose-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                โ๏ธ ุบูุฑ ุงูููุฒุนูู
                            </button>

                            <button onclick="generateCategorizedReport()"
                                class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ ูุดู (ูุฑุญูุฉ/ููุนูุฉ)
                            </button>

                            <button onclick="generateBlankLetter()"
                                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ ุฎุทุงุจ ูุงุฑุบ
                            </button>

                            <button onclick="generateUnassignedSchoolsReport()"
                                class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ซ ูุฏุงุฑุณ ุจูุง ุชูุฒูุน
                            </button>

                            <button onclick="generateBlankLetter()"
                                class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-2">
                                ๐ ุฎุทุงุจ ูุงุฑุบ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full text-right" id="mainTable">
                        <thead>
                            <tr class="bg-indigo-950/40 text-slate-400">
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest text-center w-12">
                                    <input type="checkbox" id="selectAllLetters" onchange="toggleSelectAllLetters()"
                                        class="w-4 h-4 rounded border-white/10 bg-slate-800 text-indigo-600 focus:ring-indigo-500">
                                </th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest">ุงุณู ุงููุฏุฑุณุฉ</th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest">ุงูููุฌู ุงููุณูู</th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest">ุงูุชูุฌูู</th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest">ุงููุฑุญูุฉ</th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest">ุขููุฉ ุงูุชูุฒูุน</th>
                                <th class="px-8 py-5 text-xs font-black uppercase tracking-widest text-center">ุทุจุงุนุฉ
                                </th>
                            </tr>
                        </thead>
                        <tbody id="resultBody" class="divide-y divide-white/5 font-medium">
                            <!-- Data injected here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Raw Data View -->
            <div id="admin-view-raw" class="hidden space-y-8 animate-in fade-in duration-500">
                <div class="glass rounded-[2rem] p-8">
                    <div class="flex flex-wrap gap-4 mb-8">
                        <button onclick="renderRawData('schools')"
                            class="px-4 py-2 bg-indigo-600 rounded-lg text-xs font-bold">ุจูุงูุงุช ุงููุฏุงุฑุณ</button>
                        <button onclick="renderRawData('supervisors')"
                            class="px-4 py-2 bg-slate-800 rounded-lg text-xs font-bold">ุจูุงูุงุช ุงูููุฌููู</button>
                        <button onclick="renderRawData('guidance')"
                            class="px-4 py-2 bg-slate-800 rounded-lg text-xs font-bold">ุจูุงูุงุช ุงูุชูุฌูู</button>
                    </div>

                    <div class="overflow-x-auto max-h-[600px]">
                        <table class="w-full text-right text-xs">
                            <thead id="rawTitle" class="bg-slate-900 sticky top-0">
                                <!-- Headers injected here -->
                            </thead>
                            <tbody id="rawBody" class="divide-y divide-white/5">
                                <!-- Data injected here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Global Loading Overlay -->
    <div id="globalLoader"
        class="hidden fixed inset-0 bg-slate-950/80 backdrop-blur-md z-[100] flex items-center justify-center">
        <div class="text-center">
            <div class="loading-spinner w-16 h-16 border-4 mb-6 mx-auto"></div>
            <p id="loaderText" class="text-indigo-400 font-black tracking-widest text-lg animate-pulse">ุฌุงุฑู ูุนุงูุฌุฉ
                ุงูุจูุงูุงุช...</p>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast"
        class="fixed bottom-10 left-10 translate-y-10 opacity-0 pointer-events-none transition-all duration-500 z-[100] px-6 py-4 rounded-2xl bg-slate-800 border border-indigo-500 shadow-2xl flex items-center gap-3">
        <div id="toastIcon" class="text-indigo-400"></div>
        <p id="toastMsg" class="font-bold text-sm"></p>
    </div>
    <!-- Print Container (CRITICAL FOR REPORTS) -->
    <div id="printReportContainer" class="print-only"></div>

    <div id="adminLoginModal"
        class="hidden fixed inset-0 bg-slate-950/90 backdrop-blur-sm z-[200] flex items-center justify-center">
        <div class="glass rounded-3xl p-10 max-w-md w-full mx-4 animate-in zoom-in duration-300">
            <div class="text-center mb-6">
                <div
                    class="w-16 h-16 bg-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-indigo-500/30">
                    <svg class="w-9 h-9 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                </div>
                <h2 class="text-2xl font-black mb-2">ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ</h2>
                <p class="text-slate-400 text-sm">ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ูููุตูู ุฅูู ููุญุฉ ุงูุชุญูู</p>
            </div>
            <input type="password" id="adminPasswordInput" placeholder="ูููุฉ ูุฑูุฑ ุงูุฅุฏุงุฑุฉ"
                onkeypress="if(event.key==='Enter') verifyAdminLogin()"
                class="w-full p-5 bg-slate-950/80 rounded-2xl mb-6 text-center font-mono text-lg tracking-widest border border-white/10 focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
            <div class="flex gap-3">
                <button onclick="document.getElementById('adminLoginModal').classList.add('hidden')"
                    class="flex-1 bg-slate-800 hover:bg-slate-700 py-4 rounded-2xl font-bold transition-all">
                    ุฅูุบุงุก
                </button>
                <button onclick="verifyAdminLogin()" class="flex-1 btn-premium py-4 rounded-2xl font-bold">
                    ุฏุฎูู
                </button>
            </div>
        </div>
    </div>

    <!-- Global Print Container -->
    <div id="printReportContainer"></div>

    <script src="script.js"></script>
</body>

</html>